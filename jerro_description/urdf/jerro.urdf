<robot name="jerro">
  <link name="base_footprint"></link>
  <joint name="base_joint" type="fixed">
    <parent link="base_footprint" />
    <child link="base_link" />
    <origin xyz="0 0 0.03" rpy="0 0 0" />
  </joint>
  <link name="base_link">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <box size="0.2 0.126 0.05" />
      </geometry>
      <material name="base_link-material">
        <color rgba="0.43415363616478553 0.06662593863608139 0.006048833020386069 1" />
      </material>
    </visual>
    <visual name='caster'>
      <origin xyz="-0.1007170515353214 0 -0.02059754064260888" rpy="0 0 0" />
      <geometry>
        <sphere radius="0.02" />
      </geometry>
      <material name="caster-material">
        <color rgba="0.013702083043526807 0.1912016827303171 0.010960094003125918 1" />
      </material>
    </visual>
    <collision name='caster'>
      <origin xyz="-0.1007170515353214 0 -0.02059754064260888" rpy="0 0 0" />
      <geometry>
        <sphere radius="0.02" />
      </geometry>
    </collision>
    

    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="1" />
      <inertia ixx="0.16666666666666666" ixy="0" ixz="0" iyy="0.16666666666666666" iyz="0" izz="0.16666666666666666" />
    </inertial>
  </link>
  <joint name="base_link_to_left_wheel" type="continuous">
    <parent link="base_link" />
    <child link="left_wheel" />
    <origin xyz="0.034 0.085 0" rpy="1.5707963267948963 0 0" />
    <axis xyz="0 0 -1"/>
  </joint>
  <link name="left_wheel">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <cylinder radius="0.035" length="0.024" />
      </geometry>
      <material name="left_wheel-material">
        <color rgba="0.10461648408208657 0.15592646369776456 0.00030352698352941176 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <sphere radius="0.035"/>
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="1" />
      <inertia ixx="0.3333333333333333" ixy="0" ixz="0" iyy="0.5" iyz="0" izz="0.3333333333333333" />
    </inertial>
  </link>
  <joint name="base_link_to_right_wheel" type="continuous">
    <parent link="base_link" />
    <child link="right_wheel" />
    <origin xyz="0.035 -0.085 0" rpy="1.5707963267948963 0 0" />
    <axis xyz="0 0 -1"/>
  </joint>
  <link name="right_wheel">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <cylinder radius="0.035" length="0.024" />
      </geometry>
      <material name="right_wheel-material">
        <color rgba="0.10461648408208657 0.15592646369776456 0.00030352698352941176 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <sphere radius="0.035" />
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="1" />
      <inertia ixx="0.3333333333333333" ixy="0" ixz="0" iyy="0.5" iyz="0" izz="0.3333333333333333" />
    </inertial>
  </link>
  <joint name="base_link_to_servomotor" type="revolute">
    <parent link="base_link" />
    <child link="servomotor" />
    <origin xyz="0.088 0 0.054" rpy="0 0 0" />
    <axis xyz="0 1 0"/>
    <limit effort="1000.0" lower="-1" upper="1" velocity="0.5"/>  </joint>
  <link name="servomotor">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <box size="0.055 0.044 0.03" />
      </geometry>
      <material name="servomotor-material">
        <color rgba="0.3094689228067428 0.982250550332711 0.407240211891531 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <box size="0.055 0.044 0.03" />
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="0.02" />
      <inertia ixx="0.16666666666666666" ixy="0" ixz="0" iyy="0.16666666666666666" iyz="0" izz="0.16666666666666666" />
    </inertial>
  </link>
  <joint name="servomotor_to_lidar" type="fixed">
    <parent link="servomotor" />
    <child link="lidar" />
    <origin xyz="0 0 0.035" rpy="0 0 3.1415" />
  </joint>
  <link name="lidar">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <cylinder radius="0.038" length="0.04" />
      </geometry>
      <material name="lidar-material">
        <color rgba="0.4232676699760063 0.43415363616478553 0.913098651791473 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <cylinder radius="0.038" length="0.04" />
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="0.02" />
      <inertia ixx="0.3333333333333333" ixy="0" ixz="0" iyy="0.5" iyz="0" izz="0.3333333333333333" />
    </inertial>
      </link>
  <joint name="base_link_to_raspberry" type="fixed">
    <parent link="base_link" />
    <child link="raspberry" />
    <origin xyz="-0.038177574265084016 0 0.04" rpy="0 0 0" />
  </joint>
  <link name="raspberry">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <box size="0.111 0.093 0.032" />
      </geometry>
      <material name="raspberry-material">
        <color rgba="0.0015176349176470587 0.7835377915215659 0.0027317428517647058 1" />
      </material>
    </visual>

    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="1" />
      <inertia ixx="0.16666666666666666" ixy="0" ixz="0" iyy="0.16666666666666666" iyz="0" izz="0.16666666666666666" />
    </inertial>
  </link>
  <joint name="base_link_to_camera" type="fixed">
    <parent link="base_link" />
    <child link="camera" />
    <origin xyz="0.10006549069877052 0 0" rpy="0 1.5707963267948966 0" />
  </joint>
  <link name="camera">
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <cylinder radius="0.01" length="0.01" />
      </geometry>
      <material name="camera-material">
        <color rgba="0.5271151256969157 0.0027317428517647058 0.5906188409113381 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <cylinder radius="0.01" length="0.01" />
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="1" />
      <inertia ixx="0.3333333333333333" ixy="0" ixz="0" iyy="0.5" iyz="0" izz="0.3333333333333333" />
    </inertial>
      </link>




  <!-- Gazebo-specific: sensors and plugins -->
  <gazebo reference="lidar">
    <sensor type="gpu_lidar" name="lidar_sensor">
      <always_on>true</always_on>
      <update_rate>5</update_rate>
      <ray>
        <scan>
          <horizontal>
            <samples>360</samples>
            <resolution>1</resolution>
            <min_angle>0</min_angle>
            <max_angle>6.28</max_angle>
          </horizontal>
        </scan>
        <range>
          <min>0.12</min>
          <max>3.5</max>
          <resolution>0.015</resolution>
        </range>
        <noise>
          <type>gaussian</type>
          <mean>0</mean>
          <stddev>0.01</stddev>
        </noise>
      </ray>
    </sensor>
  </gazebo>

  <gazebo reference="camera">
    <sensor type="camera" name="camera_sensor">
      <always_on>true</always_on>
      <update_rate>30</update_rate>
      <camera>
        <horizontal_fov>1.396</horizontal_fov>
        <image>
          <width>800</width>
          <height>600</height>
          <format>R8G8B8</format>
        </image>
        <clip>
          <near>0.1</near>
          <far>100</far>
        </clip>
      </camera>
    </sensor>
  </gazebo>

  <!-- Plugins -->
  <gazebo>
    <plugin filename="gz-sim-joint-controller-system" name="gz::sim::systems::JointController">
      <joint_name>base_link_to_servomotor</joint_name>
      <use_force_commands>true</use_force_commands>
      <p_gain>0.2</p_gain>
      <i_gain>0.01</i_gain>
    </plugin>
    <plugin filename="gz-sim-joint-state-publisher-system" name="gz::sim::systems::JointStatePublisher">
      <joint_name>base_link_to_servomotor</joint_name>
    </plugin>


  <plugin name="gz::sim::systems::DiffDrive" filename="gz-sim8-diff-drive-system">
    <frame_id>odom</frame_id>
    <left_joint>base_link_to_left_wheel</left_joint>
    <right_joint>base_link_to_right_wheel</right_joint>
    <wheel_separation>0.17</wheel_separation>
    <wheel_diameter>0.07</wheel_diameter>
    <topic>cmd_vel</topic>
    <odom_topic>odom</odom_topic>
    <child_frame_id>base_link</child_frame_id>
  </plugin>
  </gazebo>


</robot>
